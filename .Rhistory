theme_minimal()
ggplot() +
geom_point(data = Jackpoll.na, aes(x=AgeAtWeighing, y=pes, color = as.factor(order_birth)))+
geom_smooth(data=Jackpoll.na, aes(x = AgeAtWeighing, y = GrowthRate), method = "loess", se = FALSE, color = "red", size = 1) +  # Adding growth rate trend line
labs(x = "Age at Weighing (days)", y = "Weight (grams)", color = "Order of Birth") +
ggtitle("Chick Growth Curve by Order of Birth") +
theme_minimal()
ggplot() +
geom_line(data = Jackpoll.na, aes(x=AgeAtWeighing, y=pes, color = as.factor(order_birth)))+
geom_smooth(data=Jackpoll.na, aes(x = AgeAtWeighing, y = GrowthRate), method = "loess", se = FALSE, color = "red", size = 1) +  # Adding growth rate trend line
labs(x = "Age at Weighing (days)", y = "Weight (grams)", color = "Order of Birth") +
ggtitle("Chick Growth Curve by Order of Birth") +
theme_minimal()
ggplot() +
geom_line(data = Jackpoll.na, aes(x=AgeAtWeighing, y=pes))+
geom_smooth(data=Jackpoll.na, aes(x = AgeAtWeighing, y = GrowthRate), method = "loess", se = FALSE, color = "red", size = 1) +  # Adding growth rate trend line
labs(x = "Age at Weighing (days)", y = "Weight (grams)", color = "Order of Birth") +
ggtitle("Chick Growth Curve by Order of Birth") +
theme_minimal()
ggplot() +
geom_line()+
geom_smooth(data=Jackpoll.na, aes(x = AgeAtWeighing, y = GrowthRate), method = "loess", se = FALSE, color = "red", size = 1) +  # Adding growth rate trend line
labs(x = "Age at Weighing (days)", y = "Weight (grams)", color = "Order of Birth") +
ggtitle("Chick Growth Curve by Order of Birth") +
theme_minimal()
ggplot() +
geom_line()+
geom_smooth(data=Jackpoll.na, aes(x = AgeAtWeighing, y = GrowthRate), method = "loess", se = FALSE, color = "red", size = 1) +  # Adding growth rate trend line
labs(x = "Age at Weighing (days)", y = "Increase in weight (grams)") +
ggtitle("Chick Growth Curve by Order of Birth") +
theme_minimal()
ggplot() +
geom_line()+
geom_smooth(data=Jackpoll.na, aes(x = AgeAtWeighing, y = GrowthRate), method = "loess", se = FALSE, color = "red", size = 1) +  # Adding growth rate trend line
labs(x = "Age at Weighing (days)", y = "Increase in weight (grams)") +
ggtitle("Chick Growth Rate Curve") +
theme_minimal()
View(Jackpoll.na)
# growth rate
Jackpoll.na <- Jackpoll.na %>%
group_by(metalica_esq) %>%
mutate(WeightDiff = c(NA, diff(pes)),   # Calculate weight difference between consecutive weighings
DaysDiff = c(NA, diff(AgeAtWeighing)),  # Calculate time difference between consecutive weighings
GrowthRate = ifelse(DaysDiff > 0, WeightDiff / DaysDiff, 0))  # Calculate growth rate (grams per day)
sum_stats <- Jackpoll.na %>%
group_by(AgeAtWeighing) %>%
summarise(mean_pes = mean(pes), SD_pes = sd(pes))
ggplot() +
geom_line()+
geom_smooth(data=Jackpoll.na, aes(x = AgeAtWeighing, y = GrowthRate), method = "loess", se = FALSE, color = "red", size = 1) +  # Adding growth rate trend line
labs(x = "Age at Weighing (days)", y = "Increase in weight (grams)") +
ggtitle("Chick Growth Rate Curve") +
theme_minimal()
# growth rate
Jackpoll.na <- Jackpoll.na %>%
group_by(metalica_esq) %>%
mutate(WeightDiff = c(0, diff(pes)),   # Calculate weight difference between consecutive weighings
DaysDiff = c(0, diff(AgeAtWeighing)),  # Calculate time difference between consecutive weighings
GrowthRate = ifelse(DaysDiff > 0, WeightDiff / DaysDiff, 0))  # Calculate growth rate (grams per day)
sum_stats <- Jackpoll.na %>%
group_by(AgeAtWeighing) %>%
summarise(mean_pes = mean(pes), SD_pes = sd(pes))
View(Jackpoll.na)
ggplot() +
geom_line()+
geom_smooth(data=Jackpoll.na, aes(x = AgeAtWeighing, y = GrowthRate), method = "loess", se = FALSE, color = "red", size = 1) +  # Adding growth rate trend line
labs(x = "Age at Weighing (days)", y = "Increase in weight (grams)") +
ggtitle("Chick Growth Rate Curve") +
theme_minimal()
Jackpoll.na <- Jackpoll.na %>%
mutate(GrowthPeriod == ifelse(AgeAtWeighing<=7,Stage1, Stage2)) %>%
mutate(GrowthPeriod == ifelse(AgeAtWeighing>=15,Stage3, Stage2))
Jackpoll.na <- Jackpoll.na %>%
mutate(GrowthPeriod == ifelse(AgeAtWeighing<=7,Stage1)) %>%
mutate(GrowthPeriod == ifelse(AgeAtWeighing>=15,Stage3))
# Add new column for period intervals
Jackpoll.na <- Jackpoll.na %>%
mutate(ChickPeriod = sapply(AgeAtWeighing, assign_period))
return("Stage 1")
if (age >= 0 & age <= 7) {
return("Stage 1")
} else if (age >= 8 & age <= 14) {
return("Stage 2")
} else if (age >= 15 & age <= 21) {
return("Stage 3")
} else {
return(NA)
}
### growth periods
assign_period <- function(age) {
if (age >= 0 & age <= 7) {
return("Stage 1")
} else if (age >= 8 & age <= 14) {
return("Stage 2")
} else if (age >= 15 & age <= 21) {
return("Stage 3")
} else {
return(NA)
}
}
# Add new column for period intervals
Jackpoll.na <- Jackpoll.na %>%
mutate(ChickPeriod = sapply(AgeAtWeighing, assign_period))
p <- glmer(GrowthRate ~ ChickPeriod + (1|id_individu), data=Jackpoll.na)
p <- lmer(GrowthRate ~ ChickPeriod + (1|id_individu), data=Jackpoll.na)
summary(p)
anova(p)
r.squared(p)
rsquared(p)
p <- lm(GrowthRate ~ ChickPeriod , data=Jackpoll.na)
summary(p)
p <- lmer(GrowthRate ~ ChickPeriod + (1|idCaixaNiu), data=Jackpoll.na)
summary(p)
p <- glmer(WeightDiff ~ AgeAtWeighing + (1|metalica_esq), data=Jackpoll.na)
p <- lmer(WeightDiff ~ AgeAtWeighing + (1|metalica_esq), data=Jackpoll.na)
summary(p)
p <- lmer(pes ~ AgeAtWeighing + (1|metalica_esq), data=Jackpoll.na)
summary(p)
# from home
setwd("~/PhD/PhD/projects/transect/Trans_anal/Trans_anal")
# from home
setwd("~/PhD/PhD/projects/transect/Trans_anal")
Hoppers <- read.csv("Hoppers_a.csv", sep=";", stringsAsFactors=TRUE)
Hoppers <- Hoppers %>%
mutate(Orth = OrthCaeS+OrthCaeM+OrthCaeL+OrthEnsS+OrthEnsM+OrthEnsL+OrthUnkS+OrthUnkM+OrthUnkL) %>%
mutate(Lep = LepS+LepM+LepL) %>%
mutate(Col = ColS+ColM+ColL) %>%
mutate(Dip = DipS+DipM+DipL) %>%
mutate(Ant = AntS+AntM+AntL) %>%
mutate(Oth = OthS+OthM+OthL)
# take out outlier of day 189
Hopper <- subset(Hoppers, julian <= 180)
View(Hoppers)
## julian date
Hoppers$dat<- as.Date(Hoppers$Date, "%d/%m/%Y")
Hoppers$julian <- as.numeric(format(Hoppers$dat, "%j"))
Jackhop <- merge(Jackpoll.na, Hopper, by = "julian", all.x = TRUE, all.y = TRUE)
Jackhop <- merge(Jackpoll.na, Hoppers, by = "julian", all.x = TRUE, all.y = TRUE)
View(Jackhop)
# Calculate total orthopter count for each Julian date
total_orthopter <- Jackhop %>%
group_by(julian) %>%
summarise(TotalOrthopter = sum(Orth))
# Calculate count of chicks at each age of weighing
chick_count <- Jackhop %>%
group_by(AgeAtWeighing) %>%
summarise(ChickCount = n_distinct(metalica_esq))
ggplot() +
geom_bar(data = Jackhop, aes(x = julian, y = ChickCount, color = as.factor(AgeAtWeighing)), stat = "identity", fill = "blue", alpha = 0.5) +
geom_line(data = total_orthopter, aes(x = julian(), y = TotalOrthopter, group = 1), color = "red") +
labs(x = "Age at Weighing (days) / Julian Date", y = "Count", title = "Chick Count and Total Orthopter Count") +
scale_x_continuous(breaks = unique(c(chick_count$AgeAtWeighing, total_orthopter$JulianDate))) +
theme_minimal()
ggplot() +
geom_bar(data = Jackhop, aes(x = julian, y = ChickCount, color = as.factor(AgeAtWeighing)), stat = "identity", fill = "blue", alpha = 0.5) +
geom_line(data = total_orthopter, aes(x = julian(), y = TotalOrthopter, group = 1), color = "red") +
labs(x = "Age at Weighing (days) / Julian Date", y = "Count", title = "Chick Count and Total Orthopter Count") +
scale_x_continuous(breaks = unique(c(chick_count$AgeAtWeighing, total_orthopter$julian))) +
theme_minimal()
ggplot() +
geom_bar(data = chick_count, aes(x = julian, y = ChickCount), stat = "identity", fill = "blue", alpha = 0.5) +
geom_line(data = total_orthopter, aes(x = julian, y = TotalOrthopter, group = 1), color = "red") +
labs(x = "Age at Weighing (days) / Julian Date", y = "Count", title = "Chick Count and Total Orthopter Count") +
scale_x_continuous(breaks = unique(c(chick_count$AgeAtWeighing, total_orthopter$JulianDate))) +
theme_minimal()
# Calculate count of chicks at each age of weighing
chick_count <- Jackhop %>%
group_by(julian, AgeAtWeighing) %>%
summarise(ChickCount = n_distinct(metalica_esq))
ggplot() +
geom_bar(data = chick_count, aes(x = julian, y = ChickCount), stat = "identity", fill = "blue", alpha = 0.5) +
geom_line(data = total_orthopter, aes(x = julian, y = TotalOrthopter, group = 1), color = "red") +
labs(x = "Age at Weighing (days) / Julian Date", y = "Count", title = "Chick Count and Total Orthopter Count") +
scale_x_continuous(breaks = unique(c(chick_count$AgeAtWeighing, total_orthopter$JulianDate))) +
theme_minimal()
ggplot() +
geom_point(data = chick_count, aes(x = julian, y = ChickCount), stat = "identity", fill = "blue", alpha = 0.5) +
geom_line(data = total_orthopter, aes(x = julian, y = TotalOrthopter, group = 1), color = "red") +
labs(x = "Age at Weighing (days) / Julian Date", y = "Count", title = "Chick Count and Total Orthopter Count") +
scale_x_continuous(breaks = unique(c(chick_count$AgeAtWeighing, total_orthopter$JulianDate))) +
theme_minimal()
ggplot() +
geom_point(data = chick_count, aes(x = julian, y = ChickCount), stat = "identity", fill = "blue", alpha = 0.5) +
geom_line(data = total_orthopter, aes(x = julian, y = TotalOrthopter, group = 1), color = "red") +
labs(x = "Age at Weighing (days) / Julian Date", y = "Count", title = "Chick Count and Total Orthopter Count") +
scale_x_continuous(breaks = unique(c(chick_count$AgeAtWeighing, total_orthopter$julian))) +
theme_minimal()
View(chick_count)
View(total_orthopter)
Jackhop <- merge(Jackpoll.na, Hoppers, by = "julian", all.x = TRUE, all.y = TRUE)
View(Jackhop)
# Calculate total orthopter count for each Julian date
total_orthopter <- Jackhop %>%
group_by(julian, Tower) %>%
summarise(TotalOrthopter = sum(Orth))
View(total_orthopter)
# Calculate total orthopter count for each Julian date
total_orthopter <- Jackhop %>%
group_by(julian) %>%
summarise(TotalOrthopter = mean(Orth))
sum_stat <- Jackhop %>%
group_by(julian) %>%
summarise(mean_orth = mean(Orth), SD_orth = sd(Orth))
sum_stats <- Jackhop %>%
group_by(julian, AgeAtWeighing) %>%
summarise(ChickCount = n_distinct(metalica_esq))
summ <- merge(sum_stat, sum_stats, by = "julian", all.x = TRUE, all.y = TRUE)
View(summ)
ggplot() +
geom_point(data = summ, aes(x = julian, y = ChickCount), stat = "identity", fill = "blue", alpha = 0.5) +
geom_line(data = summ, aes(x = julian, y = mean_orth, group = 1), color = "red") +
labs(x = "Age at Weighing (days) / Julian Date", y = "Count", title = "Chick Count and Total Orthopter Count") +
theme_minimal()
ggplot() +
geom_point(data = summ, aes(x = julian, y = ChickCount), stat = "identity", fill = "blue", alpha = 0.5) +
geom_point(data = summ, aes(x = julian, y = mean_orth, group = 1), color = "red") +
labs(x = "Age at Weighing (days) / Julian Date", y = "Count", title = "Chick Count and Total Orthopter Count") +
theme_minimal()
ggplot() +
geom_point(data = summ, aes(x = julian, y = ChickCount), stat = "identity", fill = "blue", alpha = 0.5) +
geom_point(data = summ, aes(x = julian, y = mean_orth, group = 1), color = "red") +
geom_abline(data = summ, aes(x = julian, y = ChickCount))
ggplot() +
geom_point(data = summ, aes(x = julian, y = ChickCount), stat = "identity", fill = "blue", alpha = 0.5) +
geom_point(data = summ, aes(x = julian, y = mean_orth, group = 1), color = "red") +
geom_abline(data = summ)
ggplot() +
geom_point(data = summ, aes(x = julian, y = ChickCount, color = as.factor(AgeAtWeighing)), stat = "identity", fill = "blue", alpha = 0.5) +
geom_point(data = summ, aes(x = julian, y = mean_orth, group = 1), color = "red") +
geom_abline(data = summ)
# from home
setwd("~/PhD/PhD/projects/transect/Trans_anal")
# libraries for hoppers and jacks
source("libraries.R")
# jack doc
Jack <- read.csv("Jackdawta.csv", sep=";", stringsAsFactors=TRUE)
# add julian date
Jack$dat<- as.Date(Jack$data, "%d/%m/%Y")
Jack$julian <- yday(Jack$dat)
Jack$julian <- as.numeric(format(Jack$dat, "%j"))
Jackpoll <- subset(Jack, edat != "adult" & edat!="ou" & edat!="poll" & metalica_esq != "NA")
# First order chicks based on 1st day of measure within each nest.
Jackpoll <- Jackpoll %>%
arrange(idCaixaNiu, julian)
# order of birth based on date they were first weighed
Jackpoll <- Jackpoll %>%
group_by(idCaixaNiu) %>%
mutate(order_birth = ifelse(edat == "1_dia", row_number(), NA))
library(mosaic)
library(ggplot2)
library(lme4)
library(dplyr)
library(DHARMa)
library(lubridate) #work with dates
library(fitdistrplus)
library(rsq)
library(zoo)
library(pbkrtest)
library(lmerTest)
# First order chicks based on 1st day of measure within each nest.
Jackpoll <- Jackpoll %>%
arrange(idCaixaNiu, julian)
str(Jackpoll)
# order of birth based on date they were first weighed
Jackpoll <- Jackpoll %>%
group_by(idCaixaNiu) %>%
mutate(order_birth = ifelse(edat == "1_dia", row_number(), NA))
# Order chicks based on 1st day of measure within each nest and same id (different measures of same individual)
Jackpoll <- Jackpoll %>%
arrange(idCaixaNiu, metalica_esq)
Jackpoll <- Jackpoll %>%
arrange(idCaixaNiu, metalica_esq, julian) %>%
group_by(idCaixaNiu, metalica_esq) %>%
mutate(order_birth = na.locf(order_birth, na.rm = FALSE))
Jackpoll <- Jackpoll %>%
arrange(idCaixaNiu, metalica_esq, julian) %>%
group_by(idCaixaNiu, metalica_esq) %>%
mutate(order_birth = na.locf(order_birth, na.rm = FALSE))
# jack doc
Jack <- read.csv("Jackdawta.csv", sep=";", stringsAsFactors=TRUE)
# add julian date
Jack$dat<- as.Date(Jack$data, "%d/%m/%Y")
Jack$julian <- as.numeric(format(Jack$dat, "%j"))
Jackpoll <- subset(Jack, edat != "adult" & edat!="ou" & edat!="poll" & metalica_esq != "NA")
# First order chicks based on 1st day of measure within each nest.
Jackpoll <- Jackpoll %>%
arrange(idCaixaNiu, julian)
# order of birth based on date they were first weighed
Jackpoll <- Jackpoll %>%
group_by(idCaixaNiu) %>%
mutate(order_birth = ifelse(edat == "1_dia", row_number(), NA))
# Order chicks based on 1st day of measure within each nest and same id (different measures of same individual)
Jackpoll <- Jackpoll %>%
arrange(idCaixaNiu, metalica_esq)
Jackpoll <- Jackpoll %>%
arrange(idCaixaNiu, metalica_esq, julian) %>%
group_by(idCaixaNiu, metalica_esq) %>%
mutate(order_birth = na.locf(order_birth, na.rm = FALSE))
View(Jackpoll)
# Assign age to chicks
Jackpoll.na <- subset(Jackpoll, order_birth != "NA" & edat != "3_dies" & order_birth <=6)
Jackpoll.na <- Jackpoll.na %>%
group_by(metalica_esq) %>%
mutate(AgeAtWeighing = as.numeric(julian - min(julian)))
sum_stats <- Jackpoll.na %>%
group_by(order_birth, AgeAtWeighing) %>%
summarise(mean_pes = mean(pes), SD_pes = sd(pes))
sum_stats <- subset(sum_stats, SD_pes != "NA")
# Plot the growth curve with mean and standard deviation
ggplot() +
geom_line(data = sum_stats, aes(x = AgeAtWeighing, y = mean_pes,  color = as.factor(order_birth)), size = 1, linetype = "solid") +
geom_ribbon(data = sum_stats, aes(x = AgeAtWeighing, ymin = mean_pes - SD_pes, ymax = mean_pes + SD_pes), alpha = 0.3, fill="grey") +
labs(x = "Age at Weighing (days)", y = "Weight (grams)", color = "Order of Birth") +
ggtitle("Chick Growth Curve by Order of Birth")
Jackpoll.na <- subset(Jackpoll.na, metalica_esq != "L007463")
sum_stats <- Jackpoll.na %>%
group_by(order_birth, AgeAtWeighing) %>%
summarise(mean_pes = mean(pes), SD_pes = sd(pes))
sum_stats <- subset(sum_stats, SD_pes != "NA")
# Plot the growth curve with mean and standard deviation
ggplot() +
geom_line(data = sum_stats, aes(x = AgeAtWeighing, y = mean_pes,  color = as.factor(order_birth)), size = 1, linetype = "solid") +
geom_ribbon(data = sum_stats, aes(x = AgeAtWeighing, ymin = mean_pes - SD_pes, ymax = mean_pes + SD_pes), alpha = 0.3, fill="grey") +
labs(x = "Age at Weighing (days)", y = "Weight (grams)", color = "Order of Birth") +
ggtitle("Chick Growth Curve by Order of Birth")
p<-lmer(pes ~ order_birth + (1|metalica_esq) + (1|AgeAtWeighing), data = Jackpoll.na)
summary(p)
anova(p)
# growth rate
Jackpoll.na <- Jackpoll.na %>%
group_by(metalica_esq) %>%
mutate(WeightDiff = c(0, diff(pes)),   # Calculate weight difference between consecutive weighings
DaysDiff = c(0, diff(AgeAtWeighing)),  # Calculate time difference between consecutive weighings
GrowthRate = ifelse(DaysDiff > 0, WeightDiff / DaysDiff, 0))  # Calculate growth rate (grams per day)
sum_stats <- Jackpoll.na %>%
group_by(AgeAtWeighing) %>%
summarise(mean_pes = mean(pes), SD_pes = sd(pes))
ggplot() +
geom_line()+
geom_smooth(data=Jackpoll.na, aes(x = AgeAtWeighing, y = GrowthRate), method = "loess", se = FALSE, color = "red", size = 1) +  # Adding growth rate trend line
labs(x = "Age at Weighing (days)", y = "Increase in weight (grams)") +
ggtitle("Chick Growth Rate Curve") +
theme_minimal()
### growth periods
assign_period <- function(age) {
if (age >= 0 & age <= 7) {
return("Stage 1")
} else if (age >= 8 & age <= 14) {
return("Stage 2")
} else if (age >= 15 & age <= 21) {
return("Stage 3")
} else {
return(NA)
}
}
# Add new column for period intervals
Jackpoll.na <- Jackpoll.na %>%
mutate(ChickPeriod = sapply(AgeAtWeighing, assign_period))
p <- lmer(pes ~ AgeAtWeighing + (1|metalica_esq), data=Jackpoll.na)
summary(p)
View(Jackpoll.na)
p <- lmer(GrowthRate ~ ChickPeriod + (1|metalica_esq), data=Jackpoll.na)
summary(p)
anova(p)
p <- lmer(GrowthRate ~ ChickPeriod + (1|metalica_esq) + (1|idCaixaNiu), data=Jackpoll.na)
summary(p)
p <- lmer(GrowthRate ~ ChickPeriod + (1|metalica_esq) + (1|idEstructura), data=Jackpoll.na)
summary(p)
p <- lmer(GrowthRate ~ idEstructura + (1|metalica_esq) , data=Jackpoll.na)
summary(p)
p <- lmer(GrowthRate ~ idEstructura + (1|metalica_esq) + (1|ChickPeriod), data=Jackpoll.na)
summary(p)
anova(p)
J <- subset(Jackpoll.na, idEstructura == "Cadolles")
ggplot() +
geom_line()+
geom_smooth(data=J, aes(x = AgeAtWeighing, y = GrowthRate), method = "loess", se = FALSE, color = "red", size = 1) +  # Adding growth rate trend line
labs(x = "Age at Weighing (days)", y = "Increase in weight (grams)") +
ggtitle("Chick Growth Rate Curve") +
theme_minimal()
J <- subset(Jackpoll.na, idEstructura == "RocaGuilla")
ggplot() +
geom_line()+
geom_smooth(data=J, aes(x = AgeAtWeighing, y = GrowthRate), method = "loess", se = FALSE, color = "red", size = 1) +  # Adding growth rate trend line
labs(x = "Age at Weighing (days)", y = "Increase in weight (grams)") +
ggtitle("Chick Growth Rate Curve") +
theme_minimal()
J <- subset(Jackpoll.na, idEstructura == "Valldelspous")
ggplot() +
geom_line()+
geom_smooth(data=J, aes(x = AgeAtWeighing, y = GrowthRate), method = "loess", se = FALSE, color = "red", size = 1) +  # Adding growth rate trend line
labs(x = "Age at Weighing (days)", y = "Increase in weight (grams)") +
ggtitle("Chick Growth Rate Curve") +
theme_minimal()
J <- subset(Jackpoll.na, idEstructura == "ValldelsPous")
ggplot() +
geom_line()+
geom_smooth(data=J, aes(x = AgeAtWeighing, y = GrowthRate), method = "loess", se = FALSE, color = "red", size = 1) +  # Adding growth rate trend line
labs(x = "Age at Weighing (days)", y = "Increase in weight (grams)") +
ggtitle("Chick Growth Rate Curve") +
theme_minimal()
ggplot() +
geom_line()+
geom_smooth(data=Jackpoll.na, aes(x = AgeAtWeighing, y = GrowthRate), method = "loess", se = FALSE, color = "red", size = 1) +  # Adding growth rate trend line
labs(x = "Age at Weighing (days)", y = "Increase in weight (grams)") +
ggtitle("Chick Growth Rate Curve") +
theme_minimal()
# from home
setwd("~/PhD/PhD/projects/transect/Trans_anal")
Hoppers <- read.csv("Hoppers_a.csv", sep=";", stringsAsFactors=TRUE)
## julian date
Hoppers$dat<- as.Date(Hoppers$Date, "%d/%m/%Y")
Hoppers$julian <- as.numeric(format(Hoppers$dat, "%j"))
Hoppers <- Hoppers %>%
mutate(Orth = OrthCaeS+OrthCaeM+OrthCaeL+OrthEnsS+OrthEnsM+OrthEnsL+OrthUnkS+OrthUnkM+OrthUnkL) %>%
mutate(Lep = LepS+LepM+LepL) %>%
mutate(Col = ColS+ColM+ColL) %>%
mutate(Dip = DipS+DipM+DipL) %>%
mutate(Ant = AntS+AntM+AntL) %>%
mutate(Oth = OthS+OthM+OthL)
# take out outlier of day 189
Hopper <- subset(Hoppers, julian <= 180)
Hopper$period <- Hopper$julian
Hopper$period <- ifelse((Hopper$julian>=120&Hopper$julian<=125), 'A', Hopper$period)
Hopper$period <- ifelse((Hopper$julian>=125&Hopper$julian<=135), 'B', Hopper$period)
Hopper$period <- ifelse((Hopper$julian>=135&Hopper$julian<=145), 'C', Hopper$period)
Hopper$period <- ifelse((Hopper$julian>=146&Hopper$julian<=155), 'D', Hopper$period)
Hopper$period <- ifelse((Hopper$julian>=155&Hopper$julian<=165), 'E', Hopper$period)
Hopper$period <- ifelse((Hopper$julian>=165&Hopper$julian<=175), 'F', Hopper$period)
Hopper$time <- as.numeric(gsub("\\:.*$", "", Hopper$Hour))
Hopper$dayper <- Hopper$time
Hopper$dayper <- ifelse(Hopper$time >= 9 & Hopper$time<=11, 'morning', Hopper$dayper)
Hopper$dayper <- ifelse(Hopper$time > 11 & Hopper$time<=13, 'midday', Hopper$dayper)
Hopper$dayper <- ifelse(Hopper$time > 13 & Hopper$time<=15, 'afternoon', Hopper$dayper)
Hopper <-subset(Hopper, Weather!= "CloudyRainyWindy")
# CHECK THE MODEL ASSUMPTIONS OF THE LMM: normality and homoscedasticity
max.simResid<-simulateResiduals (abunP, 1000)
# Phenology is important, when both, flowers and seeds, we see generally more orthopters.
abunP <- lme4::glmer.nb(Orth ~ period + (1|Tower), data = Hopper)
summary(abunP)
View(Hopper)
ggplot() +
geom_line()+
geom_smooth(data=Jackpoll.na, aes(x = AgeAtWeighing, y = GrowthRate), method = "loess", se = FALSE, color = "red", size = 1) +  # Adding growth rate trend line
labs(x = "Age at Weighing (days)", y = "Increase in weight (grams/day)") +
ggtitle("Chick Growth Rate Curve") +
theme_minimal()
st2 <- subset(Jackpoll.na, ChickPeriod == "Stage 2")
View(st2)
ggplot() +
geom_point(data=Jackpoll.na, aes(x = ChickPeriod, y = julian))+
labs(x = "Age at Weighing (days)", y = "Increase in weight (grams/day)") +
ggtitle("Chick Growth Rate Curve") +
theme_minimal()
ggplot() +
geom_point(data=Jackpoll.na, aes(x = julian, y = ChickPeriod))+
labs(x = "Day", y = "Chick Period") +
ggtitle("Chick Growth Rate Curve") +
theme_minimal()
ggplot() +
geom_point(data=Jackpoll.na, aes(x = julian, y = AgeAtWeighing))+
labs(x = "Day", y = "Chick Period") +
ggtitle("") +
theme_minimal()
ggplot() +
geom_point(data=Jackpoll.na, aes(x = julian, y = AgeAtWeighing))+
labs(x = "Day", y = "AgeAtWeighing") +
ggtitle("") +
theme_minimal()
ggplot() +
geom_point(data=Jackpoll.na, aes(x = julian, y = AgeAtWeighing))+
geom_line(data=Hopper, aes(x=julian,y=Orth))
ggplot() +
geom_point(data=Jackpoll.na, aes(x = julian, y = AgeAtWeighing))+
geom_abline(data=Hopper, aes(x=julian,y=Orth))
## plot age chicks of diff ages at weighing day. SEE THAT MOST STAGE 2 (AGE 7-14) FALL INTO DAYS 150-155, PEAK ABUNDANCE IN ORTHOPTERS.
sum_orth <- Hopper %>%
group_by(julian) %>%
summarise(mean_orth = mean(Orth), SD_Orth = sd(Orth))
ggplot() +
geom_point(data=Jackpoll.na, aes(x = julian, y = AgeAtWeighing))+
geom_line(data=sum_orth, aes(x=julian,y=mean_orth))
View(sum_orth)
ggplot() +
geom_point(data=Jackpoll.na, aes(x = julian, y = AgeAtWeighing), color = "red")+
geom_point(data=Hopper, aes(x=julian,y=Orth), color = "blue")
p <- ggplot(Jackpoll.na, aes(x = as.factor(julian))) +
geom_bar(aes(fill = factor(AgeAtWeighing)), position = "stack") +
labs(title = "Distribution of Chicks at different ages",
x = "Julian Days",
y = "Number of Chicks") +
theme_minimal() +
theme(legend.position = "top") +
scale_fill_discrete(name = "Age")
# Add secondary y-axis for 'other_variable'
p + geom_line(data = Hopper, aes(x = julian, y = Orth * 0.5), color = "red") +
scale_y_continuous(sec.axis = sec_axis(~./0.5, name = "Orthopter abundance"))
p
# Add secondary y-axis for 'other_variable'
p + geom_line(data = sum_orth, aes(x = julian, y = mean_orth * 0.5), color = "red") +
scale_y_continuous(sec.axis = sec_axis(~./0.5, name = "Orthopter abundance"))
# Add secondary y-axis for 'other_variable'
p + geom_line(data = sum_orth, aes(x = julian, y = mean_orth), color = "red") +
scale_y_continuous(sec.axis = sec_axis(~./0.5, name = "Orthopter abundance"))
# Add secondary y-axis for 'other_variable'
p + geom_line(data = sum_orth, aes(x = julian, y = mean_orth), color = "red") +
scale_y_continuous(sec.axis = sec_axis(name = "Orthopter abundance"))
# Add secondary y-axis for 'other_variable'
p + geom_line(data = sum_orth, aes(x = julian, y = mean_orth), color = "red") +
scale_y_continuous(sec.axis = sec_axis(~, name = "Orthopter abundance"))
p<-lmer(pes ~ order_birth + (1|metalica_esq) + (1|AgeAtWeighing), data = Jackpoll.na)
summary(p)
