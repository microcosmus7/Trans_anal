ggplot(mean_egg, aes(x = idEstructura, y = pes)) +
geom_boxplot(stat = "identity") +
labs(x = "Nesting Tower", y = "Mean Egg Weight") +
ggtitle("Mean Egg Weight per Nesting Tower")
# Step 3: Create the bar plot
ggplot(mean_egg, aes(x = idEstructura, y = pes)) +
geom_boxplot() +
labs(x = "Nesting Tower", y = "Mean Egg Weight") +
ggtitle("Mean Egg Weight per Nesting Tower")
egg_summary <- Jackou %>%
group_by(idEstructura) %>%
summarise(mean_pes = mean(pes),
se_pes = sd(pes) / sqrt(n()))
install.packages("dplyr")
install.packages("dplyr")
install.packages("dplyr")
install.packages("dplyr")
install.packages("dplyr")
rs
library(dplyr)
egg_summary <- Jackou %>%
group_by(idEstructura) %>%
summarise(mean_pes = mean(pes),
se_pes = sd(pes) / sqrt(n()))
# Step 2: Create the boxplot with standard error bars
ggplot(egg_summary, aes(x = idEstructura, y = mean_pes)) +
geom_boxplot() +
geom_errorbar(aes(ymin = mean_pes - se_pes,
ymax = mean_pes + se_pes),
width = 0.2,
position = position_dodge(width = 0.75)) +
labs(x = "Nesting Tower", y = "Mean Egg Weight") +
ggtitle("Mean Egg Weight per Nesting Tower with Standard Error Bars")
library(ggplot2)
# Step 2: Create the boxplot with standard error bars
ggplot(egg_summary, aes(x = idEstructura, y = mean_pes)) +
geom_boxplot() +
geom_errorbar(aes(ymin = mean_pes - se_pes,
ymax = mean_pes + se_pes),
width = 0.2,
position = position_dodge(width = 0.75)) +
labs(x = "Nesting Tower", y = "Mean Egg Weight") +
ggtitle("Mean Egg Weight per Nesting Tower with Standard Error Bars")
fi <- lm(pes ~ idEstructura, data=Jackou)
summary(fi)
####
fit <- lmer(pes ~ idEstructura + (1|idCaixaNiu),data = Jackou)
#### creating summary for mean and sd of egg weight
egg_summary <- Jackou %>%
group_by(idEstructura) %>%
summarise(mean_pes = mean(pes),
sd_pes = sd(pes) / sqrt(n()))
# Create the boxplot with standard error bars
ggplot(egg_summary, aes(x = idEstructura, y = mean_pes)) +
geom_boxplot() +
geom_errorbar(aes(ymin = mean_pes - sd_pes,
ymax = mean_pes + sd_pes),
width = 0.2,
position = position_dodge(width = 0.75)) +
labs(x = "Nesting Tower", y = "Mean Egg Weight") +
ggtitle("Mean Egg Weight per Nesting Tower with Standard Error Bars")
Jackpoll <- subset(Jack, edat != "adult"&edat!="ou")
Jackpoll <- subset(Jack, edat != "adult" & edat!="ou" & edat!="poll")
plot(Jackpoll$pes~Jackpoll$edat)
Jackpoll <- subset(Jack, edat != "adult" & edat!="ou" & edat!="poll")
View(Jack1)
View(Jack1)
View(Jack1)
View(Jacko)
View(Jackpoll)
plot(Jackpoll$pes~Jackpoll$edat)
plot(Jackpoll$pes~Jackpoll$julian)
p<-lmer(pes ~ julian + (1|idIndividu) + (1|idIndividu/idEstructura), data = Jackpoll)
library(lme4)
p<-lmer(pes ~ julian + (1|idIndividu) + (1|idIndividu/idEstructura), data = Jackpoll)
View(Jackpoll)
p<-lmer(pes ~ julian + (1|id_individu) + (1|id_individu/idEstructura), data = Jackpoll)
summary(p)
p<-lmer(pes ~ edat + (1|id_individu) + (1|id_individu/idEstructura), data = Jackpoll)
summary(p)
p<-lmer(pes ~ julian + (1|id_individu) , data = Jackpoll)
summary(p)
p<-lmer(pes ~ julian + (1|id_individu) + (1|id_individu/idCaixaNiu) , data = Jackpoll)
summary(p)
rsq(p)
library(mosaic)
rsq(p)
####
fit <- lmer(pes ~ julian + (1|idCaixaNiu),data = Jackou)
summary(fit)
rsq(fit)
library(mosaic)
rsq(fit)
install.packages("mosaic")
library(mosaic)
rsq(fit)
Jackou <- Jackou %>%
arrange(idCaixaNiu, julian)
# Add a column for the order of the eggs within each nest
Jackou <- Jackou %>%
group_by(idCaixaNiu) %>%
mutate(egg_order = row_number())
# View the updated dataframe
head(Jackou)
View(Jackou)
## model to see order
fit <- lm(pes ~ egg_order ,data = Jackou)
summary(fit)
rsq(fit)
library(ggplot2)
# Plot scatterplot
ggplot(Jackou, aes(x = julian, y = egg_order, color = idCaixaNiu)) +
geom_point() +
labs(x = "Laying Date", y = "Egg Order") +
ggtitle("Order of Eggs within Nests") +
theme_minimal()
# Plot scatterplot
ggplot(Jackou, aes(x = pes, y = egg_order, color = idCaixaNiu)) +
geom_point() +
labs(x = "Laying Date", y = "Egg Order") +
ggtitle("Order of Eggs within Nests") +
theme_minimal()
# Plot scatterplot
ggplot(Jackou, aes(x = julian, y = pes, color = idCaixaNiu)) +
geom_point() +
labs(x = "Laying Date", y = "Egg Order") +
ggtitle("Order of Eggs within Nests") +
theme_minimal()
# Plot scatterplot
ggplot(Jackou, aes(x = julian, y = pes, color = egg_order)) +
geom_point() +
labs(x = "Laying Date", y = "Egg Order") +
ggtitle("Order of Eggs within Nests") +
theme_minimal()
# Plot scatterplot
ggplot(Jackou, aes(x = julian, y = pes, color = egg_order/idCaixaNiu)) +
geom_point() +
labs(x = "Laying Date", y = "Egg Order") +
ggtitle("Order of Eggs within Nests") +
theme_minimal()
# Plot scatterplot
ggplot(Jackou, aes(x = egg_order, y = pes, color = idCaixaNiu)) +
geom_point() +
labs(x = "Laying Date", y = "Egg Order") +
ggtitle("Order of Eggs within Nests") +
theme_minimal()
J <- subset(Jackou,idEstructura ="Cadolles")
# Plot scatterplot
ggplot(J, aes(x = egg_order, y = pes, color = idCaixaNiu)) +
geom_point() +
labs(x = "Laying Date", y = "Egg Order") +
ggtitle("Order of Eggs within Nests") +
theme_minimal()
J <- subset(Jackou,idEstructura ="Cadolles")
J <- subset(Jackou,idEstructura =="Cadolles")
# Plot scatterplot
ggplot(J, aes(x = egg_order, y = pes, color = idCaixaNiu)) +
geom_point() +
labs(x = "Laying Date", y = "Egg Order") +
ggtitle("Order of Eggs within Nests") +
theme_minimal()
# Plot scatterplot
ggplot(J, aes(x = egg_order, y = pes, color = idCaixaNiu)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
labs(x = "Laying Date", y = "Egg Order") +
ggtitle("Order of Eggs within Nests") +
theme_minimal()
# Plot scatterplot
ggplot(Jackou, aes(x = egg_order, y = pes, color = idCaixaNiu)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
labs(x = "Laying Date", y = "Egg Order") +
ggtitle("Order of Eggs within Nests") +
theme_minimal()
# Plot scatterplot
ggplot(J, aes(x = egg_order, y = pes, color = idCaixaNiu)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
labs(x = "Laying Date", y = "Egg Order") +
ggtitle("Order of Eggs within Nests") +
theme_minimal()
J <- subset(Jackou,idEstructura =="RocaGuilla")
# Plot scatterplot
ggplot(J, aes(x = egg_order, y = pes, color = idCaixaNiu)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
labs(x = "Laying Date", y = "Egg Order") +
ggtitle("Order of Eggs within Nests") +
theme_minimal()
J <- subset(Jackou,idEstructura =="TossalRodo")
# Plot scatterplot
ggplot(J, aes(x = egg_order, y = pes, color = idCaixaNiu)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
labs(x = "Laying Date", y = "Egg Order") +
ggtitle("Order of Eggs within Nests") +
theme_minimal()
J <- subset(Jackou,idEstructura =="Rabinat")
# Plot scatterplot
ggplot(J, aes(x = egg_order, y = pes, color = idCaixaNiu)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
labs(x = "Laying Date", y = "Egg Order") +
ggtitle("Order of Eggs within Nests") +
theme_minimal()
J <- subset(Jackou,idEstructura =="Valldelspous")
# Plot scatterplot
ggplot(J, aes(x = egg_order, y = pes, color = idCaixaNiu)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
labs(x = "Laying Date", y = "Egg Order") +
ggtitle("Order of Eggs within Nests") +
theme_minimal()
J <- subset(Jackou,idEstructura =="ValldelsPous")
# Plot scatterplot
ggplot(J, aes(x = egg_order, y = pes, color = idCaixaNiu)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
labs(x = "Laying Date", y = "Egg Order") +
ggtitle("Order of Eggs within Nests") +
theme_minimal()
J <- subset(Jackou,idEstructura =="PlaRoquis")
# Plot scatterplot
ggplot(J, aes(x = egg_order, y = pes, color = idCaixaNiu)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
labs(x = "Laying Date", y = "Egg Order") +
ggtitle("Order of Eggs within Nests") +
theme_minimal()
J <- subset(Jackou,idEstructura =="TossalFonta")
# Plot scatterplot
ggplot(J, aes(x = egg_order, y = pes, color = idCaixaNiu)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
labs(x = "Laying Date", y = "Egg Order") +
ggtitle("Order of Eggs within Nests") +
theme_minimal()
J <- subset(Jackou,idEstructura =="Palmero")
# Plot scatterplot
ggplot(J, aes(x = egg_order, y = pes, color = idCaixaNiu)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
labs(x = "Laying Date", y = "Egg Order") +
ggtitle("Order of Eggs within Nests") +
theme_minimal()
# Plot scatterplot
ggplot(J, aes(x = egg_order, y = pes, color = idCaixaNiu)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
labs(x = "Egg Order", y = "Weight") +
ggtitle("Weight based on Order of Eggs within Nests") +
theme_minimal()
J <- subset(Jackou,idEstructura =="TossalRodo")
# Plot scatterplot
ggplot(J, aes(x = egg_order, y = pes, color = idCaixaNiu)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
labs(x = "Egg Order", y = "Weight") +
ggtitle("Weight based on Order of Eggs within Nests") +
theme_minimal()
J <- subset(Jackou,idEstructura =="Rabinat")
# Plot scatterplot
ggplot(J, aes(x = egg_order, y = pes, color = idCaixaNiu)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
labs(x = "Egg Order", y = "Weight") +
ggtitle("Weight based on Order of Eggs within Nests") +
theme_minimal()
J <- subset(Jackou,idEstructura =="Cadolles")
# Plot scatterplot
ggplot(J, aes(x = egg_order, y = pes, color = idCaixaNiu)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
labs(x = "Egg Order", y = "Weight") +
ggtitle("Weight based on Order of Eggs within Nests") +
theme_minimal()
J <- subset(Jackou,idEstructura =="OsBalaguer")
# Plot scatterplot
ggplot(J, aes(x = egg_order, y = pes, color = idCaixaNiu)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
labs(x = "Egg Order", y = "Weight") +
ggtitle("Weight based on Order of Eggs within Nests") +
theme_minimal()
View(Jackou)
View(Jackou)
View(Jackpoll)
# Plot scatterplot
ggplot(J, aes(x = egg_order, y = volum_ou, color = idCaixaNiu)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
labs(x = "Egg Order", y = "Weight") +
ggtitle("Weight based on Order of Eggs within Nests") +
theme_minimal()
## model to see order
fit <- lm(volum_ou ~ egg_order,data = Jackou)
summary(fit)
# Plot scatterplot
ggplot(Jackou, aes(x = egg_order, y = volum_ou, color = idCaixaNiu)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
labs(x = "Egg Order", y = "Weight") +
ggtitle("Weight based on Order of Eggs within Nests") +
theme_minimal()
J <- subset(Jackou,idEstructura =="Cadolles")
# Plot scatterplot
ggplot(Jackou, aes(x = egg_order, y = volum_ou, color = idCaixaNiu)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
labs(x = "Egg Order", y = "Weight") +
ggtitle("Weight based on Order of Eggs within Nests") +
theme_minimal()
# Plot scatterplot
ggplot(J, aes(x = egg_order, y = volum_ou, color = idCaixaNiu)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
labs(x = "Egg Order", y = "Weight") +
ggtitle("Weight based on Order of Eggs within Nests") +
theme_minimal()
## model to see order
fit <- lmer(volum_ou ~ egg_order + (1|idEstructura),data = Jackou)
summary(fit)
## model to see order
fit <- lmer(volum_ou ~ egg_order + (1|idCaixaNiu),data = Jackou)
summary(fit)
## model to see order
fit <- lmer(volum_ou ~ egg_order + (1|idCaixaNiu) + (1|idCaixaNiu/idEstructura),data = Jackou)
summary(fit)
## model to see order
fit <- glmer(volum_ou ~ egg_order + (1|idCaixaNiu) + (1|idCaixaNiu/idEstructura),data = Jackou)
summary(fit)
clutch_size_data <- Jackou %>%
group_by(idCaixaNiu) %>%
summarise(clutch_size = n())
View(clutch_size_data)
# Merge the clutch size data back to the original dataset
Jackou <- left_join(Jackou, clutch_size_data, by = "idCaixaNiu")
View(Jacko)
View(Jackou)
## model to see order
fit <- lmer(volum_ou ~ egg_order + (1|idCaixaNiu) + (1|idCaixaNiu/idEstructura),data = Jackou)
summary(fit)
fit <- lmer(volum_ou ~ clutch_size + (1|idCaixaNiu) + (1|idCaixaNiu/idEstructura),data = Jackou)
summary(fit)
fit <- lmer(volum_ou ~ clutch_size + (1|idCaixaNiu),data = Jackou)
summary(fit)
fit <- lmer(volum_ou ~ clutch_size + (1|idEstructura),data = Jackou)
summary(fit)
fit <- lm(volum_ou ~ clutch_size,data = Jackou)
summary(fit)
plot(Jackou$volum_ou~Jackou$clutch_size)
fit <- lm(pes ~ clutch_size,data = Jackou)
summary(fit)
# from work
setwd("C:/Users/a.bateman/Documents/GITHUB/Trans_anal")
Hoppers <- read.csv("Hoppers_a.csv", sep=";", stringsAsFactors=TRUE)
library(ggplot2)
library(lme4)
library(dplyr)
library(DHARMa)
Hoppers <- Hoppers %>%
mutate(Orth = OrthCaeS+OrthCaeM+OrthCaeL+OrthEnsS+OrthEnsM+OrthEnsL+OrthUnkS+OrthUnkM+OrthUnkL) %>%
mutate(Lep = LepS+LepM+LepL) %>%
mutate(Col = ColS+ColM+ColL) %>%
mutate(Dip = DipS+DipM+DipL) %>%
mutate(Ant = AntS+AntM+AntL) %>%
mutate(Oth = OthS+OthM+OthL)
plot(Hoppers$Orth~Hoppers$julian) # we see there are differentiated dates with a slight trend to peak btw 150 and 160 days
# take out outlier of day 189
Hopper <- subset(Hoppers, julian <= 180)
Hopper$period <- Hopper$julian
Hopper$period <- ifelse((Hopper$julian>=120&Hopper$julian<=125), 'A', Hopper$period)
Hopper$period <- ifelse((Hopper$julian>=125&Hopper$julian<=135), 'B', Hopper$period)
Hopper$period <- ifelse((Hopper$julian>=135&Hopper$julian<=145), 'C', Hopper$period)
Hopper$period <- ifelse((Hopper$julian>=146&Hopper$julian<=155), 'D', Hopper$period)
Hopper$period <- ifelse((Hopper$julian>=155&Hopper$julian<=165), 'E', Hopper$period)
Hopper$period <- ifelse((Hopper$julian>=165&Hopper$julian<=175), 'F', Hopper$period)
Hopper$time <- as.numeric(gsub("\\:.*$", "", Hopper$Hour))
Hopper$dayper <- Hopper$time
Hopper$dayper <- ifelse(Hopper$time >= 9 & Hopper$time<=11, 'morning', Hopper$dayper)
Hopper$dayper <- ifelse(Hopper$time > 11 & Hopper$time<=13, 'midday', Hopper$dayper)
Hopper$dayper <- ifelse(Hopper$time > 13 & Hopper$time<=15, 'afternoon', Hopper$dayper)
# view sheet from now...
View(Hopper)
# Phenology is important, when both, flowers and seeds, we see generally more orthopters.
abunP <- lme4::glmer.nb(Orth ~ Phen + (1|Tower), data = Hopper)
summary(abunP)
abunPH <- lme4::glmer.nb(Orth ~ Phen + period + (1|Tower), data = Hopper)
summary(abunPH)
# Phenology is important, when both, flowers and seeds, we see generally more orthopters.
abunP <- lme4::glmer.nb(Orth ~ period + (1|Tower), data = Hopper)
summary(abunP)
abunPH <- lme4::glmer.nb(Orth ~ Phen * period + (1|Tower), data = Hopper)
# Orthopters are more abundant in the wild type of habitat, but does not matter whether Harvested or not.
abun <- lme4::glmer.nb(Ant ~ HabitatType + (1|Tower), data = Hopper)
summary(abun)
# Orthopters, ant are more abundant in the wild type of habitat, but does not matter whether Harvested or not.
abun <- lme4::glmer.nb(Lep ~ HabitatType + (1|Tower), data = Hopper)
summary(abun)
# Orthopters, ant are more abundant in the wild type of habitat, but does not matter whether Harvested or not.
abun <- lme4::glmer.nb(Dip ~ HabitatType + (1|Tower), data = Hopper)
summary(abun)
# Orthopters, ant are more abundant in the wild type of habitat, but does not matter whether Harvested or not.
abun <- lme4::glmer.nb(Cpl ~ HabitatType + (1|Tower), data = Hopper)
summary(abun)
# Orthopters, Ant, Dip and Col are more abundant in the wild type of habitat, but does not matter whether Harvested or not.
abun <- lme4::glmer.nb(Col ~ HabitatType + (1|Tower), data = Hopper)
summary(abun)
# from work
setwd("C:/Users/a.bateman/Documents/GITHUB/Trans_anal")
Jack <- read.csv("Jackdawta.csv", sep=";", stringsAsFactors=TRUE)
# see structure of data
str(Jack)
# add julian date
Jack$dat<- as.Date(Jack$data, "%d/%m/%Y")
Jack$julian <- yday(Jack$dat)
Jack$julian <- as.numeric(format(Jack$dat, "%j"))
# Separate the eggs of jackdaws
Jackou <- subset(Jack,edat == "ou" & pes>0 & volum_ou>0)
plot(Jackou$pes ~ Jackou$volum_ou)
uu <-lmer(pes ~ volum_ou + (1|idCaixaNiu), data=Jackou)
summary(uu)
rsq(uu)
library(mosaic)
install.packages("mosaic")
library(mosaic)
rsq(uu)
library(DHARMa)
rsq(uu)
library(mosaic)
library(ggplot2)
library(lme4)
library(dplyr)
library(DHARMa)
library(lubridate) #work with dates
library(fitdistrplus)
rsq(uu)
library(rsq)
rsq(uu)
summary(uu)
rsq(uu)
####
fit <- lmer(pes ~ julian + (1|idCaixaNiu),data = Jackou)
summary(fit)
rsq(fit)
### we see that cadolles has heavier eggs than the other towers, but valldels pous.
fi <- lm(pes ~ idEstructura, data=Jackou)
summary(fi)
#### creating summary for mean and sd of egg weight
egg_summary <- Jackou %>%
group_by(idEstructura) %>%
summarise(mean_pes = mean(pes),
sd_pes = sd(pes) / sqrt(n()))
# Create the boxplot with standard deviation bars
ggplot(egg_summary, aes(x = idEstructura, y = mean_pes)) +
geom_boxplot() +
geom_errorbar(aes(ymin = mean_pes - sd_pes,
ymax = mean_pes + sd_pes),
width = 0.2,
position = position_dodge(width = 0.75)) +
labs(x = "Nesting Tower", y = "Mean Egg Weight") +
ggtitle("Mean Egg Weight per Nesting Tower with Standard Error Bars")
# First order eggs based on laying date within each nest.
Jackou <- Jackou %>%
arrange(idCaixaNiu, julian)
# Add a column for the order of the eggs within each nest
Jackou <- Jackou %>%
group_by(idCaixaNiu) %>%
mutate(egg_order = row_number())
## model to see order
fit <- lmer(volum_ou ~ egg_order + (1|idCaixaNiu) + (1|idCaixaNiu/idEstructura),data = Jackou)
summary(fit)
# Plot scatterplot
ggplot(Jackou, aes(x = egg_order, y = volum_ou, color = idCaixaNiu)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
labs(x = "Egg Order", y = "Weight") +
ggtitle("Weight based on Order of Eggs within Nests") +
theme_minimal()
J <- subset(Jackou,idEstructura =="Cadolles")
# Plot scatterplot
ggplot(J, aes(x = egg_order, y = volum_ou, color = idCaixaNiu)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
labs(x = "Egg Order", y = "Weight") +
ggtitle("Weight based on Order of Eggs within Nests") +
theme_minimal()
# Plot scatterplot
ggplot(J, aes(x = egg_order, y = volum_ou, color = idCaixaNiu)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
labs(x = "Egg Order", y = "Volume") +
ggtitle("Weight based on Order of Eggs within Nests") +
theme_minimal()
J <- subset(Jackou,idEstructura =="TossalRodo")
# Plot scatterplot
ggplot(J, aes(x = egg_order, y = volum_ou, color = idCaixaNiu)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
labs(x = "Egg Order", y = "Volume") +
ggtitle("Weight based on Order of Eggs within Nests") +
theme_minimal()
clutch_size_data <- Jackou %>%
group_by(idCaixaNiu) %>%
summarise(clutch_size = n())
# Merge the clutch size data back to the original dataset
Jackou <- left_join(Jackou, clutch_size_data, by = "idCaixaNiu")
fit <- lm(pes ~ clutch_size,data = Jackou)
summary(fit)
fit <- lm(volum_ou ~ clutch_size,data = Jackou)
summary(fit)
