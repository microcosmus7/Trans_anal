# Calculate synchrony values for each egg within clutch
Jackou_syn <- Jackou_syn %>%
mutate(synchrony_nest = julian - mean_laying_date)
View(Jackou_syn)
## so, does colony size affect egg weight?
fit1 <- lmer(synchrony_tower ~ colony_size + (1|idEstructura), data = Jackou_syn)
summary(fit1)
## so, does colony size affect egg weight?
fit1 <- lmer(synchrony_nest ~ colony_size + (1|idEstructura), data = Jackou_syn)
summary(fit1)
fit <- lmer(pes ~ volum_ou + synchrony_nest + (1|idCaixaNiu) + (1|idEstructura), data = Jackou_syn)
summary(fit)
fit <- lmer(pes ~  synchrony_nest + (1|idCaixaNiu) + (1|idEstructura), data = Jackou_syn)
summary(fit)
fit <- lmer(pes ~  synchrony_tower + (1|idCaixaNiu) + (1|idEstructura), data = Jackou_syn)
summary(fit)
fit <- lmer(pes ~  synchrony_nest + (1|idCaixaNiu) + (1|idEstructura), data = Jackou_syn)
summary(fit)
Jackou_syn_1 <- subset(Jackou_syn, Jackou_syn$egg_order == 1)
fit <- lmer(pes ~ synchrony_nest + (1|idEstructura), data = Jackou_syn_1)
summary(fit)
fit <- lmer(volum_ou ~  synchrony_nest + (1|idCaixaNiu) + (1|idEstructura), data = Jackou_syn)
summary(fit)
# Read the TIME sheet into a data frame
Time <- read.csv("Time_arrival.csv", sep=";", stringsAsFactors=TRUE)
# add julian date
Time$dat<- as.Date(Time$data, "%d/%m/%Y")
Time$julian <- as.numeric(format(Time$dat, "%j"))
## filter to get only 2023
Time <- subset(Time, Time$any == 2023)
# Merge the two data frames based on towerID and date
Jackou_t <- merge(Jackou, Time, by = c("julian", "idEstructura"))
View(Jackou_t)
## delete columns that are not needed
Jackou_t <- subset(Jackou_t, select = -c(id_Social,any.y,data.y,X,X.1,X.2,X.3,X.4,X.5,X.6,X.7,dat.y))
##first convert time to character
Jackou_t$hora_c <- as.character(Jackou_t$hora)
# Function to convert time string to minutes past midnight
time_to_minutes <- function(time_str) {
time_parts <- strsplit(time_str, ":")[[1]]
hours <- as.numeric(time_parts[1])
minutes <- as.numeric(time_parts[2])
seconds <- as.numeric(time_parts[3])
total_minutes <- hours * 60 + minutes
return(total_minutes)
}
# Apply the function to the 'time' column
Jackou_t$hora_cont <- unlist(lapply(Jackou_t$hora, time_to_minutes))
# Function to convert time string to minutes past midnight
time_to_minutes <- function(time_str) {
hours <- as.numeric(substr(time_str, 1, 2))  # Extract hours
minutes <- as.numeric(substr(time_str, 4, 5))  # Extract minutes
total_minutes <- hours * 60 + minutes
return(total_minutes)
}
# Apply the function to the 'time' column
Jackou_t$hora_cont <- unlist(lapply(Jackou_t$hora, time_to_minutes))
# Function to convert time string to minutes past midnight
time_to_minutes <- function(time_str) {
hours <- as.numeric(substr(time_str, 1, 2))  # Extract hours
minutes <- as.numeric(substr(time_str, 4, 5))  # Extract minutes
total_minutes <- hours * 60 + minutes
return(total_minutes)
}
##first convert time to character
Jackou_t$hora_c <- as.character(Jackou_t$hora)
# Function to convert time string to minutes past midnight
time_to_minutes <- function(time_str) {
hours <- as.numeric(substr(time_str, 1, 2))  # Extract hours
minutes <- as.numeric(substr(time_str, 4, 5))  # Extract minutes
total_minutes <- hours * 60 + minutes
return(total_minutes)
}
# Apply the function to the 'time' column
Jackou_t$hora_cont <- unlist(lapply(Jackou_t$hora, time_to_minutes))
# see whether time affects egg weight. What should be random? tower and nest. What should be fixed? time
fit <- lmer(pes ~ hora_cont + (1|idCaixaNiu) + (1|idEstructura), data = Jackou_t)
summary(fit)
Ja <- subset(Jackou_t, Jackou_t$egg_order==1)
fit <- lmer(pes ~ hora_cont + (1|idEstructura), data = Ja)
summary(fit)
library(mosaic)
library(ggplot2)
library(lme4)
library(dplyr)
library(DHARMa)
library(lubridate) #work with dates
library(fitdistrplus)
library(rsq)
library(zoo)
library(pbkrtest)
library(lmerTest)
# from work
setwd("C:/Users/a.bateman/Documents/GITHUB/Trans_anal")
# jack doc
Jack <- read.csv("Jackdawta.csv", sep=";", stringsAsFactors=TRUE)
# add julian date
Jack$dat<- as.Date(Jack$data, "%d/%m/%Y")
Jack$julian <- as.numeric(format(Jack$dat, "%j"))
# Separate the eggs of jackdaws
Jackou <- subset(Jack,edat == "ou" & pes>0 & volum_ou>0)
plot(Jackou$pes ~ Jackou$volum_ou)
uu <-lmer(pes ~ volum_ou + (1|idCaixaNiu) + (1|idEstructura), data=Jackou)
summary(uu)
uu <- lmer(pes ~ julian + (1|idCaixaNiu) + (1|idEstructura), data=Jackou) # i don't know if nesting idCaixaNiu is correct
summary(uu)
### we see that cadolles has heavier eggs than the other towers, but valldels pous.
fi <- lm(pes/volum_ou ~ idEstructura, data=Jackou)
summary(fi)
# Read the TIME sheet into a data frame
Time <- read.csv("Time_arrival.csv", sep=";", stringsAsFactors=TRUE)
# add julian date
Time$dat<- as.Date(Time$data, "%d/%m/%Y")
Time$julian <- as.numeric(format(Time$dat, "%j"))
## filter to get only 2023
Time <- subset(Time, Time$any == 2023)
# Merge the two data frames based on towerID and date
Jackou_t <- merge(Jackou, Time, by = c("julian", "idEstructura"))
## delete columns that are not needed
Jackou_t <- subset(Jackou_t, select = -c(id_Social,any.y,data.y,X,X.1,X.2,X.3,X.4,X.5,X.6,X.7,dat.y))
##first convert time to character
Jackou_t$hora_c <- as.character(Jackou_t$hora)
# Function to convert time string to minutes past midnight
time_to_minutes <- function(time_str) {
time_parts <- strsplit(time_str, ":")[[1]]
hours <- as.numeric(time_parts[1])
minutes <- as.numeric(time_parts[2])
seconds <- as.numeric(time_parts[3])
total_minutes <- hours * 60 + minutes
return(total_minutes)
}
# Function to convert time string to minutes past midnight
time_to_minutes <- function(time_str) {
hours <- as.numeric(substr(time_str, 1, 2))  # Extract hours
minutes <- as.numeric(substr(time_str, 4, 5))  # Extract minutes
total_minutes <- hours * 60 + minutes
return(total_minutes)
}
# Apply the function to the 'time' column
Jackou_t$hora_cont <- unlist(lapply(Jackou_t$hora, time_to_minutes))
# see whether time affects egg weight. What should be random? tower and nest. What should be fixed? time
fit <- lmer(pes ~ idEstructura + (1|hora_cont), data = Jackou_t)
summary(fit)
fi <- lmer(pes ~ idEstructura, data = Jackou_t)
fi <- lm(pes ~ idEstructura, data = Jackou_t)
AIC(fit,fi)
Ja <- subset(Jackou_t, Jackou_t$egg_order==1)
# see whether time affects egg weight. What should be random? tower and nest. What should be fixed? time
fit <- lmer(pes ~ idEstructura + (1|hora_cont), data = Ja)
summary(fit)
## first arrange data
Jackou <- Jackou %>%
arrange(idCaixaNiu, julian)
## then add order of eggs based on clutch
Jackou <- Jackou %>%
group_by(idCaixaNiu) %>%
mutate(egg_order = row_number())
Jackou <- Jackou %>%
group_by(idCaixaNiu, julian) %>%
mutate(certainty = ifelse(n() > 1, "uncertain", "certain"))
# View the updated dataframe
View(Jackou)
# Merge the two data frames based on towerID and date
Jackou_t <- merge(Jackou, Time, by = c("julian", "idEstructura"))
## delete columns that are not needed
Jackou_t <- subset(Jackou_t, select = -c(id_Social,any.y,data.y,X,X.1,X.2,X.3,X.4,X.5,X.6,X.7,dat.y))
##first convert time to character
Jackou_t$hora_c <- as.character(Jackou_t$hora)
# Function to convert time string to minutes past midnight
time_to_minutes <- function(time_str) {
hours <- as.numeric(substr(time_str, 1, 2))  # Extract hours
minutes <- as.numeric(substr(time_str, 4, 5))  # Extract minutes
total_minutes <- hours * 60 + minutes
return(total_minutes)
}
# Apply the function to the 'time' column
Jackou_t$hora_cont <- unlist(lapply(Jackou_t$hora, time_to_minutes))
Ja <- subset(Jackou_t, Jackou_t$egg_order==1)
# see whether time affects egg weight. What should be random? tower and nest. What should be fixed? time
fit <- lmer(pes ~ idEstructura + (1|hora_cont), data = Ja)
summary(fit)
Ja <- subset(Jackou_t, Jackou_t$egg_order==5)
# see whether time affects egg weight. What should be random? tower and nest. What should be fixed? time
fit <- lmer(pes ~ idEstructura + (1|hora_cont), data = Ja)
summary(fit)
# from work
setwd("C:/Users/a.bateman/Documents/GITHUB/Trans_anal")
library(mosaic)
library(ggplot2)
library(lme4)
library(dplyr)
library(DHARMa)
library(lubridate) #work with dates
library(fitdistrplus)
library(rsq)
library(zoo)
library(pbkrtest)
library(lmerTest)
#### upload needed docs - first jackdaw data
# jack doc
Jack <- read.csv("Jackdawta.csv", sep=";", stringsAsFactors=TRUE)
# see structure of data
str(Jack)
# add julian date
Jack$dat<- as.Date(Jack$data, "%d/%m/%Y")
Jack$julian <- as.numeric(format(Jack$dat, "%j"))
# Separate the eggs of jackdaws
Jackou <- subset(Jack,edat == "ou" & pes>0 & volum_ou>0)
plot(Jackou$pes ~ Jackou$volum_ou)
str(Jackou)
# DISTRIBUTION OF WEIGHT SEEMS TO BE NORMAL
descdist( data = Jackou$pes , discrete = T) # if you have continuous data --> discrete = F. The closest the observation is to a distributions, the more likely it's to show that distribution.
descdist(data = Jackou$pes, discrete = T, boot=1000)
#### Add a column for the order of the eggs within each nest
## first arrange data
Jackou <- Jackou %>%
arrange(idCaixaNiu, julian)
## then add order of eggs based on clutch
Jackou <- Jackou %>%
group_by(idCaixaNiu) %>%
mutate(egg_order = row_number())
Jackou <- Jackou %>%
group_by(idCaixaNiu, julian) %>%
mutate(certainty = ifelse(n() > 1, "uncertain", "certain"))
# View the updated dataframe
View(Jackou)
## Get a CLUTCH SIZE for each nest
Jackou <- Jackou %>%
group_by(idCaixaNiu) %>%
mutate(clutch_size = n_distinct(pes))
## get the NUMBER OF NESTS per tower
Jackou <- Jackou %>%
group_by(idEstructura) %>%
mutate(colony_size = n_distinct(idCaixaNiu))
##
# Sort the data by measurement date
Jackou <- Jackou %>% arrange(idCaixaNiu, julian)
# Group the data by clutch ID
Jackou <- Jackou %>% group_by(idCaixaNiu)
# Calculate laying date for each clutch
Jackou <- Jackou %>%
mutate(laying_date = min(julian))
# Calculate mean laying date for each clutch
Jackou <- Jackou %>%
group_by(idEstructura) %>%
mutate(mean_laying_date = mean(laying_date))
# Calculate synchrony values for each clutch within tower
Jackou <- Jackou %>%
mutate(synchrony_tower = laying_date - mean_laying_date)
# Calculate synchrony values for each egg within clutch
Jackou <- Jackou %>%
mutate(synchrony_nest = julian - mean_laying_date)
View(Jackou)
# Read the TIME sheet into a data frame
Time <- read.csv("Time_arrival.csv", sep=";", stringsAsFactors=TRUE)
# add julian date
Time$dat<- as.Date(Time$data, "%d/%m/%Y")
Time$julian <- as.numeric(format(Time$dat, "%j"))
## filter to get only 2023
Time <- subset(Time, Time$any == 2023)
# Merge the two data frames based on towerID and date
Jackou_t <- merge(Jackou, Time, by = c("julian", "idEstructura"))
## delete columns that are not needed
Jackou_t <- subset(Jackou_t, select = -c(id_Social,any.y,data.y,X,X.1,X.2,X.3,X.4,X.5,X.6,X.7,dat.y))
##first convert time to character
Jackou_t$hora_c <- as.character(Jackou_t$hora)
# Function to convert time string to minutes past midnight
time_to_minutes <- function(time_str) {
hours <- as.numeric(substr(time_str, 1, 2))  # Extract hours
minutes <- as.numeric(substr(time_str, 4, 5))  # Extract minutes
total_minutes <- hours * 60 + minutes
return(total_minutes)
}
# Apply the function to the 'time' column
Jackou_t$hora_cont <- unlist(lapply(Jackou_t$hora, time_to_minutes))
View(Jackou_t)
#### upload needed docs - first jackdaw data
# jack doc
Jack <- read.csv("Jackdawta.csv", sep=";", stringsAsFactors=TRUE)
# see structure of data
str(Jack)
# add julian date
Jack$dat<- as.Date(Jack$data, "%d/%m/%Y")
Jack$julian <- as.numeric(format(Jack$dat, "%j"))
# Separate the eggs of jackdaws
Jackou <- subset(Jack,edat == "ou" & pes>0 & volum_ou>0)
plot(Jackou$pes ~ Jackou$volum_ou)
str(Jackou)
# DISTRIBUTION OF WEIGHT SEEMS TO BE NORMAL
descdist( data = Jackou$pes , discrete = T) # if you have continuous data --> discrete = F. The closest the observation is to a distributions, the more likely it's to show that distribution.
descdist(data = Jackou$pes, discrete = T, boot=1000)
#### Add a column for the order of the eggs within each nest
## first arrange data
Jackou <- Jackou %>%
arrange(idCaixaNiu, julian)
## then add order of eggs based on clutch
Jackou <- Jackou %>%
group_by(idCaixaNiu) %>%
mutate(egg_order = row_number())
Jackou <- Jackou %>%
group_by(idCaixaNiu, julian) %>%
mutate(certainty = ifelse(n() > 1, "uncertain", "certain"))
## Get a CLUTCH SIZE for each nest
Jackou <- Jackou %>%
group_by(idCaixaNiu) %>%
mutate(clutch_size = n_distinct(pes))
## get the NUMBER OF NESTS per tower
Jackou <- Jackou %>%
group_by(idEstructura) %>%
mutate(colony_size = n_distinct(idCaixaNiu))
##
# Sort the data by measurement date
Jackou <- Jackou %>% arrange(idCaixaNiu, julian)
# Group the data by clutch ID
Jackou <- Jackou %>% group_by(idCaixaNiu)
# Calculate laying date for each clutch
Jackou <- Jackou %>%
mutate(laying_date = min(julian))
# Calculate mean laying date for each clutch
Jackou <- Jackou %>%
group_by(idEstructura) %>%
mutate(mean_laying_date = mean(laying_date))
# Calculate synchrony values for each clutch within tower
Jackou <- Jackou %>%
mutate(synchrony_tower = laying_date - mean_laying_date)
# Calculate synchrony values for each egg within clutch
Jackou <- Jackou %>%
mutate(synchrony_nest = julian - mean_laying_date)
View(Jackou)
# Read the TIME sheet into a data frame
Time <- read.csv("Time_arrival.csv", sep=";", stringsAsFactors=TRUE)
# add julian date
Time$dat<- as.Date(Time$data, "%d/%m/%Y")
Time$julian <- as.numeric(format(Time$dat, "%j"))
## filter to get only 2023
Time <- subset(Time, Time$any == 2023)
# Merge the two data frames based on towerID and date
Jackou_t <- merge(Jackou, Time, by = c("julian", "idEstructura"))
## delete columns that are not needed
Jackou_t <- subset(Jackou_t, select = -c(id_Social,any.y,data.y,X,X.1,X.2,X.3,X.4,X.5,X.6,X.7,dat.y))
##first convert time to character
Jackou_t$hora_c <- as.character(Jackou_t$hora)
# Function to convert time string to minutes past midnight
time_to_minutes <- function(time_str) {
hours <- as.numeric(substr(time_str, 1, 2))  # Extract hours
minutes <- as.numeric(substr(time_str, 4, 5))  # Extract minutes
total_minutes <- hours * 60 + minutes
return(total_minutes)
}
# Apply the function to the 'time' column
Jackou_t$hora_cont <- unlist(lapply(Jackou_t$hora, time_to_minutes))
View(Jackou_t)
# Convert time column to POSIXct format
Jackou_t$hora <- as.POSIXct(Jackou_t$hora, format = "%H:%M")
# Define time intervals
intervals <- c(as.POSIXct("07:30", format = "%H:%M"),
as.POSIXct("11:00", format = "%H:%M"),
as.POSIXct("13:00", format = "%H:%M"),
as.POSIXct("15:00", format = "%H:%M"),
as.POSIXct("17:00", format = "%H:%M"),
as.POSIXct("20:00", format = "%H:%M"))
# Define labels for time categories
labels <- c("early_morning", "morning", "midday", "afternoon", "late_afternoon")
# Add a column with time categories
Jackou_t$categoria_hora <- cut(Jackou_t$hora, breaks = intervals, labels = labels, right = FALSE)
View(Jackou_t)
f <- lmer(pes ~ idEstructura + (1|categoria_hora), data=Jackou)
f <- lmer(pes ~ idEstructura + (1|categoria_hora), data=Jackou_t)
summary(f)
f <- lmer(pes ~ idEstructura + (1|hora_c), data=Jackou_t)
summary(f)
f <- lmer(pes ~ idEstructura + (1|hora_cont), data=Jackou_t)
summary(f)
### we see that cadolles has heavier eggs than the other towers, but valldelsPous.
fi <- lm(pes ~ idEstructura, data=Jackou)
summary(fi)
## we create a dataframe without uncertainty.
Jackou_certain <- subset(Jackou, Jackou$certainty != "uncertain")
## model to see whether order affects weight
fit <- lmer(pes ~ egg_order + julian + (1|idCaixaNiu) + (1|idEstructura), data = Jackou_certain)
summary(fit)
## model to see order effect on volume
fit <- lmer(volum_ou ~ egg_order + (1|julian) + (1|idCaixaNiu) + (1|idEstructura), data = Jackou_certain)
summary(fit)
## model to see order effect on volume
fit <- lmer(volum_ou ~ egg_order + (1|idCaixaNiu) + (1|idEstructura), data = Jackou_certain)
summary(fit)
## model to see whether order affects weight
fit <- lmer(pes ~ egg_order + (1|idCaixaNiu) + (1|idEstructura), data = Jackou_certain)
summary(fit)
## model to see whether order affects weight
fit <- lmer(pes ~ egg_order + julian + (1|idCaixaNiu) + (1|idEstructura), data = Jackou_certain)
summary(fit)
## model to see whether order affects weight
fit <- lmer(pes ~ egg_order + (1|julian) + (1|idCaixaNiu) + (1|idEstructura), data = Jackou_certain)
summary(fit)
## model to see whether order affects weight (is there some variance explained by laying date?)
fit1 <- lmer(pes ~ egg_order + (1|idCaixaNiu) + (1|idEstructura), data = Jackou_certain)
fit2 <- lmer(pes ~ egg_order + julian + (1|idCaixaNiu) + (1|idEstructura), data = Jackou_certain)
fit3 <- lmer(pes ~ egg_order + (1|julian) + (1|idCaixaNiu) + (1|idEstructura), data = Jackou_certain)
AIC(fit1,fit2,fit3)
## model to see order effect on volume
fit <- lmer(volum_ou ~ egg_order + (1|idCaixaNiu) + (1|idEstructura), data = Jackou_certain)
summary(fit)
## model to see order effect on volume
fit1 <- lmer(volum_ou ~ egg_order + (1|idCaixaNiu) + (1|idEstructura), data = Jackou_certain)
fit2 <- lmer(volum_ou ~ egg_order + julian + (1|idCaixaNiu) + (1|idEstructura), data = Jackou_certain)
fit3 <- lmer(volum_ou ~ egg_order + (1|julian) + (1|idCaixaNiu) + (1|idEstructura), data = Jackou_certain)
AIC(fit1,fit2,fit3)
## make two categories of egg laying order
Jackou_certain$egg_order2 <- ifelse(Jackou_certain$egg_order==1, "First",
ifelse(Jackou_certain$egg_order==5,"Second",NA))
fit2 <- lmer(volum_ou ~ egg_order2 + julian + (1|idCaixaNiu) + (1|idEstructura), data = Jackou)
summary(fit2)
## does volume relate to weight based on tower id when only considering the last egg?
Jackou_FirstEgg <- subset(Jackou_certain, Jackou_certain$egg_order==5)
fit1 <- lmer(log10(pes) ~ log10(volum_ou)*idEstructura + julian +I(julian^2) + (1|idCaixaNiu) + (1|idEstructura), data = Jackou_certain)
fit2 <- lmer(log10(pes) ~ log10(volum_ou)*idEstructura + julian + (1|idEstructura), data = Jackou_certain)
fit3 <- lmer(log10(pes) ~ log10(volum_ou)*idEstructura + julian +I(julian^2) + (1|idEstructura), data = Jackou_certain)
fit4 <- lmer(log10(pes) ~ log10(volum_ou) + idEstructura + julian + I(julian^2) + (1|idEstructura), data = Jackou_certain)
AIC(fit1, fit2, fit3, fit4) ##fit3 is the best based on AIC values
summary(fit2)
anova(fit2)
AIC(fit1, fit2, fit3, fit4) ##fit2 is the best based on AIC values
summary(fit2)
## does volume relate to weight based on tower id when only considering the last egg?
Jackou_FirstEgg <- subset(Jackou_certain, Jackou_certain$egg_order==5)
fit1 <- lmer(log10(pes) ~ log10(volum_ou)*idEstructura + julian +I(julian^2) + (1|idCaixaNiu) + (1|idEstructura), data = Jackou_FirstEgg)
fit2 <- lmer(log10(pes) ~ log10(volum_ou)*idEstructura + julian + (1|idEstructura), data = Jackou_FirstEgg)
fit3 <- lmer(log10(pes) ~ log10(volum_ou)*idEstructura + julian +I(julian^2) + (1|idEstructura), data = Jackou_FirstEgg)
fit4 <- lmer(log10(pes) ~ log10(volum_ou) + idEstructura + julian + I(julian^2) + (1|idEstructura), data = Jackou_FirstEgg)
AIC(fit2, fit3, fit4) ##fit2 is the best based on AIC values
summary(fit4)
## does volume relate to weight based on tower id when only considering the last egg?
Jackou_FirstEgg <- subset(Jackou_certain, Jackou_certain$egg_order==1)
fit2 <- lmer(log10(pes) ~ log10(volum_ou)*idEstructura + julian + (1|idEstructura), data = Jackou_FirstEgg)
fit3 <- lmer(log10(pes) ~ log10(volum_ou)*idEstructura + julian +I(julian^2) + (1|idEstructura), data = Jackou_FirstEgg)
fit4 <- lmer(log10(pes) ~ log10(volum_ou) + idEstructura + julian + I(julian^2) + (1|idEstructura), data = Jackou_FirstEgg)
AIC(fit2, fit3, fit4) ##fit2 is the best based on AIC values
summary(fit2)
#### Are there differences in volume, weight and density between the 1st and 5th egg?
## make two categories of egg laying order
Jackou_certain$egg_order2 <- ifelse(Jackou_certain$egg_order==1, "First",
ifelse(Jackou_certain$egg_order==5,"Second",NA))
## does order explain volume?
fit1 <- lmer(volum_ou ~ egg_order2 + (1|idCaixaNiu) + (1|idEstructura), data = Jackou_certain)
fit2 <- lmer(volum_ou ~ egg_order2 + julian + (1|idCaixaNiu) + (1|idEstructura), data = Jackou_certain)
fit3 <- lmer(volum_ou ~ egg_order2 + julian + I(julian^2) + (1|idCaixaNiu) + (1|idEstructura), data = Jackou_certain)
AIC(fit1, fit2, fit3)
## does order explain weight?
fit1 <- lmer(pes ~ egg_order2 + (1|idCaixaNiu) + (1|idEstructura), data = Jackou_certain)
fit2 <- lmer(pes ~ egg_order2 + julian + (1|idCaixaNiu) + (1|idEstructura), data = Jackou_certain)
fit3 <- lmer(pes ~ egg_order2 + julian + I(julian^2) + (1|idCaixaNiu) + (1|idEstructura), data = Jackou_certain)
AIC(fit1, fit2, fit3)
summary(fit1)
fit1 <- lmer(pes ~ clutch_size + (1|idCaixaNiu) + (1|idEstructura), data = Jackou)
fit2 <- lmer(pes ~ clutch_size + julian + (1|idCaixaNiu) + (1|idEstructura), data = Jackou)
fit3 <- lmer(pes ~ clutch_size + julian + I(julian^2) + (1|idCaixaNiu) + (1|idEstructura), data = Jackou)
AIC(fit1, fit2, fit3) ## fit2 is the better fit
summary(fit2)
## does this vary with only eggs we are certain of?
Jackou_certain <- subset(Jackou, Jackou$certainty != "uncertain")
fit1 <- lmer(pes ~ clutch_size + (1|idCaixaNiu) + (1|idEstructura), data = Jackou_certain)
fit2 <- lmer(pes ~ clutch_size + julian + (1|idCaixaNiu) + (1|idEstructura), data = Jackou_certain)
fit3 <- lmer(pes ~ clutch_size + julian + I(julian^2) + (1|idCaixaNiu) + (1|idEstructura), data = Jackou_certain)
AIC(fit1, fit2, fit3) ## fit2 is the better fit
summary(fit2)
## does this depend on the egg_order? Whether the clutch size affects weight differently based on the order the egg was layed -- dont know how to test this.
fit1 <- lmer(pes ~ clutch_size*egg_order2 + (1|idCaixaNiu) + (1|idEstructura), data = Jackou_certain)
#### Are there differences in volume, weight and density between the 1st and 5th egg?
## make two categories of egg laying order
Jackou_certain$egg_order2 <- ifelse(Jackou_certain$egg_order==1, "First",
ifelse(Jackou_certain$egg_order==5,"Second",NA))
fit1 <- lmer(pes ~ clutch_size*egg_order2 + (1|idCaixaNiu) + (1|idEstructura), data = Jackou_certain)
fit2 <- lmer(pes ~ clutch_size + egg_order2 + (1|idCaixaNiu) + (1|idEstructura), data = Jackou_certain)
AIC(fit1,fit2)
summary(fit2)
## so, does colony size affect egg weight?
fit1 <- lmer(weight ~ colony_size + (1|idEstructura), data = Jackou_syn)
## so, does colony size affect egg weight?
fit1 <- lmer(pes ~ colony_size + (1|idEstructura), data = Jackou)
summary(fit1)
## so, does colony size affect egg weight?
fit1 <- lmer(volum_ou ~ colony_size + (1|idEstructura), data = Jackou)
summary(fit1)
### no, but does it affect synchrony?
fit1 <- lmer(synchrony ~ colony_size + (1|idEstructura), data = Jackou)
summary(fit1)
### no, but does it affect synchrony?
fit1 <- lmer(synchrony_tower ~ colony_size + (1|idEstructura), data = Jackou)
summary(fit1)
### no, but does it affect synchrony?
fit1 <- lmer(synchrony_tower ~ colony_size + idEstructura + (1|idEstructura), data = Jackou)
summary(fit1)
fit <- lmer(volum_ou ~  synchrony_nest + (1|idCaixaNiu) + (1|idEstructura), data = Jackou)
summary(fit)
View(Jackou)
### no, but does it affect synchrony?
fit1 <- lmer(synchrony_tower ~ colony_size + (1|idEstructura), data = Jackou)
summary(fit1)
fit <- lmer(volum_ou ~  synchrony_nest + (1|idCaixaNiu) + (1|idEstructura), data = Jackou)
summary(fit)
### no, but does it affect synchrony?
fit1 <- lmer(synchrony_nest ~ colony_size + (1|idEstructura), data = Jackou)
summary(fit1)
fit <- lmer(volum_ou ~  synchrony_nest + (1|idCaixaNiu) + (1|idEstructura), data = Jackou)
summary(fit)
fit <- lmer(pes ~  synchrony_nest + (1|idCaixaNiu) + (1|idEstructura), data = Jackou)
summary(fit)
Jackou_1 <- subset(Jackou, Jackou$egg_order == 1)
fit <- lmer(pes ~ synchrony_nest + (1|idEstructura), data = Jackou_1)
summary(fit)
